name: test-and-build 
on:
  push:
    tags:
      - v*
    branches:
      - crt-build-and-tests 
  pull_request:

jobs:
  validate-helm-gen:
    runs-on: ubuntu-latest
    steps:
      - name: TODO
        run:
         echo "Filler"

  go-fmt-and-vet-helm-gen:
    uses: hashicorp/consul-k8s/.github/workflows/reusable-go-fmt-and-vet.yml@crt-build-and-tests
    with:
      directory: hack/helm-reference-gen

  unit-helm-gen:
    uses: hashicorp/consul-k8s/.github/workflows/reusable-unit.yml@crt-build-and-tests
    with:
      directory: hack/helm-reference-gen
    needs: go-fmt-and-vet-helm-gen

  lint-control-plane:
    runs-on: ubuntu-latest
    steps:
      - name: TODO
        run:
         echo "Filler"

  go-fmt-vet-control-plane:
    uses: hashicorp/consul-k8s/.github/workflows/reusable-go-fmt-and-vet.yml@crt-build-and-tests
    with:
      directory: control-plane 

  test-control-plane:
    runs-on: ubuntu-latest
    steps:
      - name: TODO
        run:
         echo "Filler"
    needs: [lint-control-plane, go-fmt-vet-control-plane]

  test-enterprise-control-plane:
    runs-on: ubuntu-latest
    steps:
      - name: TODO
        run:
         echo "Filler"
    needs: [lint-control-plane, go-fmt-vet-control-plane]




