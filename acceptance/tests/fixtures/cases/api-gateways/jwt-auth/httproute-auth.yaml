# Copyright (c) HashiCorp, Inc.
# SPDX-License-Identifier: MPL-2.0

apiVersion: gateway.networking.k8s.io/v1beta1
kind: HTTPRoute
metadata:
  name: http-route-auth
spec:
  parentRefs:
  - name: gateway
    sectionName: http-auth
  rules:
    - matches:
      - path:
          type: PathPrefix
          value: "/admin"
      backendRefs:
        - name: static-server
          port: 80
      filters:
      - type: ExtensionRef
        extensionRef:
          group: consul.hashicorp.com
          kind: HTTPRouteAuthFilter
          name: route-jwt-auth-filter
    - matches:
      - path:
          type: PathPrefix
          value: "/pet"
      backendRefs:
        - name: static-server
          port: 80
